<script>
    function submit() {
        var fromYear = Number(document.getElementById('fromYear').value);
        var toYear = Number(document.getElementById('toYear').value);
        if (!fromYear || !toYear || fromYear < 0 || toYear < 0) {
            showError("Года должны быть натуральными числами");
            return;
        }
        if (fromYear > toYear) {
            showError("Год начала не может быть больше года окончания");
            return;
        }
        hideError();
        google.script.run.createMainSpreadsheetSheet(fromYear, toYear);
        google.script.host.close()
    }

    function showError(message) {
        var element = document.getElementById('error');
        element.classList.remove('hidden');
        element.innerHTML = 'Ошибка: ' + message;
    }
    
    function hideError() {
        var element = document.getElementById('error');
        element.classList.add('hidden');
    }
</script>

